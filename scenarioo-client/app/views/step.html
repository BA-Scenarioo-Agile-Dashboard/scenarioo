<!-- scenarioo-client
Copyright (C) 2014, scenarioo.org Development Team

This program is free software: you can redistribute it and/or modify
it under the terms of the GNU General Public License as published by
the Free Software Foundation, either version 3 of the License, or
(at your option) any later version.

This program is distributed in the hope that it will be useful,
but WITHOUT ANY WARRANTY; without even the implied warranty of
MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the
GNU General Public License for more details.

You should have received a copy of the GNU General Public License
along with this program.  If not, see <http://www.gnu.org/licenses/>.
-->

<sc-breadcrumb></sc-breadcrumb>

<div ng-show="stepNotFound" id="stepNotFoundErrorMessage">
    <div class="alert alert-warning" role="alert">
        <div class="sc-alert-title">The step you are looking for does not exist</div>
        <p>URL: {{getCurrentUrl()}}</p>
        <p>REST URL to get step: {{httpResponse.url}}</p>
        <p>HTTP method: {{httpResponse.method}}</p>
        <p>HTTP response status: {{httpResponse.status}}</p>
        <p>Response data: {{httpResponse.data}}</p>
    </div>
</div>

<!-- Navigation toolbar -->
<div class="step-navigation row sc-space-top sc-space-bottom" ng-hide="stepNotFound">

    <!-- Step & Page Navigation -->
    <div class="col-lg-5">

        <!-- Pages navigation -->
        <div class="btn-group">
            <div ng-click="goToPreviousPage()" class="btn btn-default" ng-disabled="isFirstPage()" id="prevPageBtn">
                <i class="icon-with-padding icon-large icon-double-angle-left" tooltip="Previous Page [Ctrl+Left]" tooltip-placement="bottom"></i>
            </div>
            <div class="btn btn-default btn-no-hover"><span tooltip="of all pages in this scenario" tooltip-placement="bottom">Page {{getCurrentPageIndexForDisplay()}} of {{pagesAndSteps.length}}</span></div>
            <div ng-click="goToNextPage()" class="btn btn-default" ng-disabled="isLastPage()" id="nextPageBtn">
                <i class="icon-with-padding icon-large icon-double-angle-right" tooltip="Next Page [Ctrl+Right]" tooltip-placement="bottom"></i>
            </div>
        </div>

        &nbsp;

        <!-- Steps navigation -->
        <div class="btn-group">
            <div ng-click="goToPreviousStep()" class="btn btn-default" ng-disabled="isFirstStep()" id="prevStepBtn">
                <i class="icon-with-padding icon-large icon-angle-left" tooltip="Previous Step [Left]" tooltip-placement="bottom"></i>
            </div>
            <div class="btn btn-default btn-no-hover"><span tooltip="of all steps in this scenario" tooltip-placement="bottom">Step {{getCurrentStepIndexForDisplay()}} of {{stepsCountOverall}}</span></div>
            <div ng-click="goToNextStep()" class="btn btn-default" ng-disabled="isLastStep()" id="nextStepBtn">
                <i class="icon-with-padding icon-large icon-angle-right" tooltip="Next Step [Right]" tooltip-placement="bottom"></i>
            </div>
        </div>

        &nbsp;

        <!-- Substep information -->
        <div class="btn-group">
            <div class="btn btn-comment">Substep {{getStepIndexInCurrentPageForDisplay()}} of {{getNumberOfStepsInCurrentPageForDisplay()}} on current page</div>
        </div>

    </div>

    <!-- Page variants navigation -->
    <div class="col-lg-3">
        <div class="btn-group">
            <div ng-click="goToPreviousVariant()" class="btn btn-default" id="prevPageVariantBtn" ng-disabled="isFirstPageVariantStep()">
                <i class="icon-with-padding icon-large icon-angle-up" tooltip="Previous variant (potentially in other scenario) [Ctrl+Up]" tooltip-placement="bottom"></i>
            </div>
            <div class="btn btn-default btn-no-hover">
                <span tooltip="of this same page in all scenarios" tooltip-placement="bottom">
                Page-Variant  {{stepNavigation.pageVariantIndex + 1}} of {{stepNavigation.pageVariantsCount}}
                </span>
            </div>
            <div ng-click="goToNextVariant()" class="btn btn-default" id="nextPageVariantBtn" ng-disabled="isLastPageVariantStep()">
                <i class="icon-with-padding icon-large icon-angle-down" tooltip="Next variant (potentially in other scenario) [Ctrl+Down]" tooltip-placement="bottom"></i>
            </div>
        </div>
    </div>
    <div class="col-lg-4">
        <sc-meta-data-button  class="pull-right" linking-variable="stepShowMetadata" local-storage-key="step" ></sc-meta-data-button>


        <button class="btn btn-default" style="float: right;" data-toggle="modal" data-target="#stepLinksDialog">
            Show Step URL
        </button>
    </div>
</div>

<!-- screenshot and information -->
<sc-meta-data-panel linking-variable="stepShowMetadata" ng-hide="stepNotFound">
    <div>
        <tabset class="step-panes">
            <tab heading="Screenshot">
                <div class="sc-screenshot-border">
                    <img ng-src="{{getScreenShotUrl(step.stepDescription.screenshotFileName)}}" class="sc-screenshot"/>
                </div>
            </tab>
            <tab heading="HTML">
                <pre ng-bind="formattedHtml">
                </pre>
            </tab>
        </tabset>
    </div>

    <div>
        <!-- step -->
        <sc-collapsable-panel title="Step" key="stepView-step" initially-expanded="false">
            <sc-tree data='stepInformationTree'></sc-tree>
        </sc-collapsable-panel>

        <!-- labels -->
        <sc-collapsable-panel title="Labels" key="stepView-labels" initially-expanded="false" ng-show="hasAnyLabels()">
            <div class="sc-tree">
                <ul>
                    <li>
                        <div class="sc-treeNodeObject">
                            <div class="sc-treeNodeObjectTitle">
                                <span class="sc-node-label">Use case: </span>
                                <span ng-repeat="label in useCaseLabels.labels" class="label label-info sc-label" ng-style="getLabelStyle(label)">{{label}}</span>
                            </div>
                        </div>
                    </li>

                    <li>
                        <div class="sc-treeNodeObject">
                            <div class="sc-treeNodeObjectTitle">
                                <span class="sc-node-label">Scenario: </span>
                                <span ng-repeat="label in scenarioLabels.labels" class="label label-info sc-label" ng-style="getLabelStyle(label)">{{label}}</span>
                            </div>
                        </div>
                    </li>

                    <li>
                        <div class="sc-treeNodeObject">
                            <div class="sc-treeNodeObjectTitle">
                                <span class="sc-node-label">Step: </span>
                                <span ng-repeat="label in step.labels.labels" class="label label-info sc-label" ng-style="getLabelStyle(label)">{{label}}</span>
                            </div>
                        </div>
                    </li>

                    <li>
                        <div class="sc-treeNodeObject">
                            <div class="sc-treeNodeObjectTitle">
                                <span class="sc-node-label">Page: </span>
                                <span ng-repeat="label in step.page.labels.labels" class="label label-info sc-label" ng-style="getLabelStyle(label)">{{label}}</span>
                            </div>
                        </div>
                    </li>

                </ul>
            </div>

        </sc-collapsable-panel>
        <!-- meta info -->
        <sc-metadata-tree metadata-tree="metadataTree"></sc-metadata-tree>
    </div>
</sc-meta-data-panel>

<!-- Modal -->
<div class="modal fade" id="stepLinksDialog" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal"><span aria-hidden="true">&times;</span><span class="sr-only">Close</span></button>
                <h1 class="modal-title" id="myModalLabel">Step links</h1>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label for="stepLinkField">Step link</label>
                    <input type="email" class="form-control" id="stepLinkField">
                </div>
                <div class="form-group">
                    <label for="screenshotLinkField">Screenshot link</label>
                    <input type="email" class="form-control" id="screenshotLinkField">
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal">Close</button>
            </div>
        </div>
    </div>
</div>